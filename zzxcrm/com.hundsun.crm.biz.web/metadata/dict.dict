<?xml version="1.0" encoding="UTF-8"?>
<metadata:DictionaryList xmlns:metadata="http://www.hundsun.com/ares/studio/jres/metadata/1.0.0">
  <operations title="生成字典常量" code="importPackage(java.lang);&#xA;importPackage(java.io);&#xA;importPackage(java.util);&#xA;importPackage(org.eclipse.jface.dialogs);&#xA;&#xA;//脚本改造，将用户常量生成Java文件改造为数据字典生成Java&#xA;//2011-10-20 王彬&#xA;&#xA;var begin = &quot;\n&quot;+&quot;public class DictConstant {\n&quot;;&#xA;&#xA;var end = &quot;}\n&quot;;&#xA;&#xA;var path = &quot;constant&quot;;&#xA;var project = res.getARESProject().getProject();&#xA;var resource = util.getSrcFolder(project).getFile(&quot;constant\\DictConstant.java&quot;);&#xA;var fileName = resource.getLocation().toOSString();&#xA;&#xA;var metadataUtil = classLoader.loadClass(&quot;com.hundsun.ares.studio.jres.model.metadata.util.MetadataUtil&quot;).newInstance();&#xA;var stringUtil = classLoader.loadClass(&quot;org.apache.commons.lang.StringUtils&quot;).newInstance();&#xA;var sb = new StringBuffer();&#xA;var errorLogInfo = new StringBuffer();//错误提示信息&#xA;var warninginfo = &quot;false&quot;;//源文件为空预检查&#xA;&#xA;sb.append(&quot;package &quot;+path+&quot;;\n&quot;);&#xA;sb.append(begin);&#xA;sb.append(&quot;\n&quot;);&#xA;getAllConstants(sb);&#xA;sb.append(end);&#xA;&#xA;var status = util.genFile(fileName, sb.toString(),  errorLogInfo.toString(), &quot;utf-8&quot;, true);&#xA;&#xA;if(warninginfo.equals(&quot;true&quot;)){//预检查源文件内容是否为空&#xA;&#x9;MessageDialog.openWarning(null,&quot;警告&quot;, &quot;源文件内容为空，请填写后再进行操作！&quot;);&#xA;}else{&#xA;&#x9;if (!status.isOK()) {&#xA;&#x9;&#x9;MessageDialog.openError(&quot;生成失败&quot;, status.getMessage());&#xA;&#x9;} else {&#xA;&#x9;&#x9;if(errorLogInfo.toString().equals(&quot;&quot;)){&#xA;&#x9;&#x9;&#x9;resource.refreshLocal(0, null);&#xA;&#x9;&#x9;&#x9;MessageDialog.openInformation(null,&quot;生成成功&quot;, &quot;文件生成完毕！生成路径：&quot; + fileName);&#xA;&#x9;&#x9;}else{&#xA;&#x9;&#x9;&#x9;resource.refreshLocal(0, null);&#xA;&#x9;&#x9;&#x9;MessageDialog.openWarning(null,&quot;生成成功但源文件存在错误&quot;, &#xA;&#x9;&#x9;&#x9;&#x9;&quot;文件生成完毕！生成路径：&quot; +fileName+&#xA;&#x9;&#x9;&#x9;&#x9;&quot;\n\n&quot;+&quot;需导出JAVA源文件中存在如下错误：\n&quot; + errorLogInfo + &quot;\n\n其余信息已正常生成相应文件&quot;);&#xA;&#x9;&#x9;}&#x9;&#x9;&#xA;&#x9;}&#xA;}&#xA;&#xA;function getAllConstants(sb){&#xA;&#x9;//获取数据字典列表信息，判断资源文件是否为空&#xA;&#x9;var dictTypeSize = info.getItems().size();&#xA;&#x9;if(0 == dictTypeSize){&#xA;&#x9;&#x9;warninginfo = &quot;true&quot;;&#xA;&#x9;}&#xA;&#x9;else{&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;for(var i=0; i&lt;dictTypeSize; i++){&#xA;&#x9;&#x9;&#x9;//读取资源文件中信息&#xA;&#x9;&#x9;&#x9;var dictType = metadataUtil.decrypt(info.getItems().get(i), res);&#xA;&#x9;&#x9;&#x9;var refID = info.getItems().get(i).getRefId();&#xA;&#x9;&#x9;&#x9;if(stringUtil.isBlank(refID)){&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;var dictName = dictType.getName();&#xA;&#x9;&#x9;&#x9;&#x9;var dictCNName = dictType.getChineseName();&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;var dictItemSize = dictType.getItems().size();&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;if(0 == dictItemSize){&#xA;&#x9;&#x9;&#x9;&#x9;}else{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;for(var j=0; j&lt;dictItemSize; j++){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictItem = dictType.getItems().get(j);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictConstName = dictItem.getConstantName();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictValue = dictItem.getValue();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictInfo = dictItem.getChineseName();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(stringUtil.isBlank(dictConstName) || stringUtil.isBlank(dictValue)){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}else{&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(0==j){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\n\t/** &quot;+dictName +&quot; &quot;+dictCNName+&quot; **/\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\tpublic static final String &quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(dictConstName + &quot; = &quot;);&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\&quot;&quot; + dictValue + &quot;\&quot;&quot; + &quot;;&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\t// &quot; + dictInfo + &quot;\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;}else{&#xA;&#x9;&#x9;&#x9;&#x9;try{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefTypeResPair = metadataUtil.resolve(info.getItems().get(i), res);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if(null != dictRefTypeResPair){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefType = dictRefTypeResPair.first;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefName = dictRefType.getName();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefCNName = dictRefType.getChineseName();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dicRefItems = dictRefType.getItems();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefItemSize = dicRefItems.size();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(0 == dictRefItemSize){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else if(1 == dictRefItemSize){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefItem = dicRefItems.get(0);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefConstName = dictRefItem.getConstantName();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefValue = dictRefItem.getValue();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefInfo = dictRefItem.getChineseName();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(stringUtil.isBlank(dictRefConstName) || stringUtil.isBlank(dictRefValue)){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}else{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\n\t/** 字典项[&quot;+info.getItems().get(i).getName() +&quot;]存在引用  &quot;+refID+&quot; **/\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\t//public static final String &quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(dictRefConstName + &quot; = &quot;);&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\&quot;&quot; + dictRefValue + &quot;\&quot;&quot; + &quot;;&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\t// &quot; + dictRefInfo + &quot;\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;for(var k=0; k&lt;dictItemSize; k++){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefItem = dicRefItems.get(k);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefConstName = dictRefItem.getConstantName();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefValue = dictRefItem.getValue();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var dictRefInfo = dictRefItem.getChineseName();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(stringUtil.isBlank(dictRefConstName) || stringUtil.isBlank(dictRefValue)){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}else{&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(0==k){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\n\t/** 字典项[&quot;+info.getItems().get(i).getName() +&quot;]存在引用  &quot;+refID+&quot; **/\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\t//public static final String &quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(dictRefConstName + &quot; = &quot;);&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\&quot;&quot; + dictRefValue + &quot;\&quot;&quot; + &quot;;&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\t// &quot; + dictRefInfo + &quot;\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dictRefItemSize = 0;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}else{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dictERName = info.getItems().get(i).getName();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorLogInfo.append(&quot;错误：数据字典ID为[&quot;+dictERName+&quot;]引用的[&quot;+refID+&quot;]不存在\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;catch (e){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;dictERName = info.getItems().get(i).getName();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;errorLogInfo.append(&quot;错误：数据字典ID为[&quot;+dictERName+&quot;]循环引用\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}//数据字典生成Java&#xA;"/>
  <root/>
</metadata:DictionaryList>
