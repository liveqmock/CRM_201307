<?xml version="1.0" encoding="UTF-8"?>
<metadata:ErrorNoList xmlns:metadata="http://www.hundsun.com/ares/studio/jres/metadata/1.0.0">
  <operations title="导出错误号定义文件" code="importPackage(java.lang);&#xA;importPackage(java.io);&#xA;importPackage(java.util);&#xA;importPackage(org.eclipse.jface.dialogs);&#xA;&#xA;var path = &quot;constant&quot;;&#xA;var project = res.getARESProject().getProject();&#xA;var resource = util.getSrcFolder(project).getFile(&quot;constant\\bizErrorMessageFormat.properties&quot;);&#xA;&#xA;var metadataUtil = classLoader.loadClass(&quot;com.hundsun.ares.studio.jres.model.metadata.util.MetadataUtil&quot;).newInstance();&#xA;var stringUtil = classLoader.loadClass(&quot;org.apache.commons.lang.StringUtils&quot;).newInstance();&#xA;&#xA;var sb = new StringBuffer();&#xA;var errorLogInfo = new StringBuffer();//错误提示信息&#xA;var warninginfo = &quot;false&quot;;&#xA;&#xA;sb.append(&quot;#The encoding of this file is UTF-8\n&quot;)&#xA;&#xA;genAllErrorNoProperty(sb);&#xA;var fileName = resource.getLocation().toOSString();&#xA;var status = util.genFile(fileName , sb.toString(), errorLogInfo.toString(), &quot;utf-8&quot;, true);&#xA;&#xA;//生成资源文件并保存至对应文件夹&#xA;if(warninginfo.equals(&quot;true&quot;)){&#xA;&#x9;MessageDialog.openWarning(null,&quot;警告&quot;,&quot;源文件内容为空，请填写后再进行操作！&quot;);&#xA;}else{&#xA;&#x9;&#xA;&#x9;if (!status.isOK()) {&#xA;&#x9;&#x9;MessageDialog.openError(&quot;生成失败&quot;, status.getMessage());&#xA;&#x9;} else {&#xA;&#x9;&#x9;if(errorLogInfo.toString().equals(&quot;&quot;)){&#xA;&#x9;&#x9;&#x9;resource.refreshLocal(0, null);&#xA;&#x9;&#x9;&#x9;MessageDialog.openInformation(null,&quot;生成成功&quot;, &quot;文件生成完毕！生成路径：&quot; + fileName);&#xA;&#x9;&#x9;}else{&#xA;&#x9;&#x9;&#x9;resource.refreshLocal(0, null);&#xA;&#x9;&#x9;&#x9;MessageDialog.openWarning(null,&quot;生成成功但源文件存在错误&quot;, &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&quot;文件生成完毕！生成路径：&quot; + fileName +&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&quot;\n\n&quot;+&quot;需导出错误号定义文件的源文件中存在如下错误：\n&quot; + errorLogInfo+&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&quot;\n\n其余信息已正常生成相应文件&quot;);&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;&#xA;function genAllErrorNoProperty(sb) {&#xA;&#x9;&#xA;&#x9;var errInfoItems = info.getItems().size();&#xA;&#x9;&#xA;&#x9;if(errInfoItems == 0){&#xA;&#x9;&#x9;warninginfo = &quot;true&quot;;&#xA;&#x9;}&#xA;&#x9;else{&#xA;&#x9;&#x9;for(var i = 0 ; i &lt; errInfoItems ; i++){&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;var errItem = metadataUtil.decrypt(info.getItems().get(i), res);&#xA;&#x9;&#x9;&#x9;var refId = info.getItems().get(i).getRefId();//错误号引用&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;var errorNo = errItem.getNo();//错误号编号&#xA;&#x9;&#x9;&#x9;var errorID = errItem.getName();//错误号ID&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;var j = i+1;&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;if(stringUtil.isBlank(refId)){&#x9;//判断错误号引用是否存在&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;var errorMes = errItem.getMessage();//获取错误号信息&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;if(stringUtil.isBlank(errorID)){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;#错误：当前资源第[&quot;+j+&quot;]条记录ID为空\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;errorLogInfo.append(&quot;错误：当前资源第[&quot;+j+&quot;]条记录ID为空\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;else if(stringUtil.isBlank(errorNo)){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;#错误：ID为[&quot;+errorID+&quot;]的错误号编号为空\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;errorLogInfo.append(&quot;错误：ID为[&quot;+errorID+&quot;]的错误号编号为空\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;}else if(stringUtil.isBlank(errorMes)){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;#错误：错误号编号[&quot;+errorNo+&quot;]的错误信息为空\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;errorLogInfo.append(&quot;错误：错误号编号[&quot;+errorNo+&quot;]的错误信息为空\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;}else{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if(errorNo.search(&quot;^(\\-?)\\d*$&quot;)==0){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;//组装资源文件&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(errorNo+&quot;=&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(util.toUnicode(errorMes == null ? &quot;&quot; : errorMes, false));&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}else{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;#错误：ID为[&quot;+errorID+&quot;]的错误号编号[&quot;+errorNo+&quot;]为非整数或非数字\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorLogInfo.append(&quot;错误：ID为[&quot;+errorID+&quot;]的错误号编号[&quot;+errorNo+&quot;]为非整数或非数字\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}else{&#xA;&#x9;&#x9;&#x9;&#x9;try {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;var errRefItem = metadataUtil.decrypt(info.getItems().get(i), res);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if(null != errRefItem){&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var errorRefID = errRefItem.getName();//错误号ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;var errorRefNO = errRefItem.getNo();//错误号编号&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;#引用资源：当前ID为[&quot;+errorID+&quot;]的错误号资源引用资源对应的错误号编号为[&quot;+errorRefNO+&quot;]\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}else{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.append(&quot;#错误：ID为[&quot;+errorID+&quot;]引用的资源[&quot;+refId+&quot;]不存在\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;errorLogInfo.append(&quot;#错误：ID为[&quot;+errorID+&quot;]引用的资源[&quot;+refId+&quot;]不存在\n&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;} catch (e) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;exception = &quot;true&quot;;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;"/>
  <root/>
</metadata:ErrorNoList>
